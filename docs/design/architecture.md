# ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

ç™½é›ªå·´ãƒ•ã‚¡ãƒ³ã‚µã‚¤ãƒˆï¼ˆDiopsideï¼‰ã®ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆæ›¸

## ğŸ¯ æ¦‚è¦

Diopsideã¯ã€ç™½é›ªå·´VTuberã®é…ä¿¡ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã‚’ç®¡ç†ãƒ»é–²è¦§ã™ã‚‹ãŸã‚ã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚AWSä¸Šã§ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹æ§‹æˆã‚’æ¡ç”¨ã—ã€ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«ã§è²»ç”¨åŠ¹ç‡ã®é«˜ã„ã‚·ã‚¹ãƒ†ãƒ ã‚’å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚

## ğŸ—ï¸ ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Internet                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   WAF v2                                        â”‚
â”‚              (Web Application Firewall)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 CloudFront                                      â”‚
â”‚            (Content Delivery Network)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                           â”‚
              â–¼                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     S3 Bucket       â”‚         â”‚   API Gateway       â”‚
â”‚   (Static Web)      â”‚         â”‚   (HTTP API)        â”‚
â”‚                     â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                   â”‚
â”‚ â”‚   Next.js       â”‚ â”‚                   â–¼
â”‚ â”‚   Frontend      â”‚ â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”‚   (Static)      â”‚ â”‚         â”‚      Lambda         â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚         â”‚   (FastAPI App)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚     DynamoDB        â”‚
                                â”‚  (Archive Data)     â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
| æŠ€è¡“ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç”¨é€” |
|------|-----------|------|
| **Next.js** | 15.x | React ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ |
| **React** | 19.x | UI ãƒ©ã‚¤ãƒ–ãƒ©ãƒª |
| **TypeScript** | 5.x | å‹å®‰å…¨ãªé–‹ç™º |
| **Tailwind CSS** | 3.x | ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚° |

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
| æŠ€è¡“ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç”¨é€” |
|------|-----------|------|
| **FastAPI** | 0.115.x | Web API ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ |
| **Python** | 3.13 | ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èª |
| **Pydantic** | 2.x | ãƒ‡ãƒ¼ã‚¿ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ |
| **Mangum** | 0.19.x | Lambda ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ |

### ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£
| ã‚µãƒ¼ãƒ“ã‚¹ | ç”¨é€” | ç‰¹å¾´ |
|----------|------|------|
| **AWS Lambda** | ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒˆ | è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã€å¾“é‡èª²é‡‘ |
| **Amazon DynamoDB** | NoSQL ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ | é«˜æ€§èƒ½ã€è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚° |
| **Amazon S3** | ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ | é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚° |
| **Amazon CloudFront** | CDN | ã‚°ãƒ­ãƒ¼ãƒãƒ«é…ä¿¡ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ |
| **AWS API Gateway** | API ç®¡ç† | HTTP APIã€CORSå¯¾å¿œ |
| **AWS WAF** | Web ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ« | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¿è­· |

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### DynamoDB ãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆ

#### ArchiveMetadata ãƒ†ãƒ¼ãƒ–ãƒ«

```
ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼: PK (String)
ã‚½ãƒ¼ãƒˆã‚­ãƒ¼: SK (String)

ãƒ‡ãƒ¼ã‚¿æ§‹é€ :
PK: "YEAR#2024"
SK: "VIDEO#dQw4w9WgXcQ"

å±æ€§:
- video_id: String (YouTubeå‹•ç”»ID)
- title: String (å‹•ç”»ã‚¿ã‚¤ãƒˆãƒ«)
- tags: List<String> (éšå±¤ã‚¿ã‚°)
- year: Number (å…¬é–‹å¹´)
- thumbnail_url: String (ã‚µãƒ ãƒã‚¤ãƒ«URL)
- created_at: String (ä½œæˆæ—¥æ™‚)
- updated_at: String (æ›´æ–°æ—¥æ™‚)
```

#### Global Secondary Index (GSI)

```
GSIå: ByTag
ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼: Tag (String)
ã‚½ãƒ¼ãƒˆã‚­ãƒ¼: SK (String)

ç”¨é€”: ã‚¿ã‚°ãƒ™ãƒ¼ã‚¹ã§ã®é«˜é€Ÿæ¤œç´¢
```

### ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³

1. **å¹´åˆ¥å‹•ç”»å–å¾—**: `PK = "YEAR#2024"` ã§ã‚¯ã‚¨ãƒª
2. **ç‰¹å®šå‹•ç”»å–å¾—**: `PK = "YEAR#2024", SK = "VIDEO#videoId"` ã§å–å¾—
3. **ã‚¿ã‚°æ¤œç´¢**: GSI `ByTag` ã‚’ä½¿ç”¨ã—ã¦ã‚¿ã‚°ãƒ™ãƒ¼ã‚¹æ¤œç´¢
4. **ãƒ©ãƒ³ãƒ€ãƒ å‹•ç”»**: Scanæ“ä½œã§ãƒ©ãƒ³ãƒ€ãƒ ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°

## ğŸŒ API è¨­è¨ˆ

### RESTful API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

```
GET    /                          # ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
GET    /health                    # ã‚µãƒ¼ãƒ“ã‚¹çŠ¶æ…‹ç¢ºèª
GET    /api/videos                # å‹•ç”»ä¸€è¦§å–å¾—
GET    /api/videos/{video_id}     # ç‰¹å®šå‹•ç”»å–å¾—
GET    /api/videos/by-tag         # ã‚¿ã‚°åˆ¥å‹•ç”»å–å¾—
GET    /api/videos/random         # ãƒ©ãƒ³ãƒ€ãƒ å‹•ç”»å–å¾—
GET    /api/videos/memory         # ãƒ¡ãƒ¢ãƒªãƒ¼ã‚²ãƒ¼ãƒ ç”¨å‹•ç”»å–å¾—
GET    /api/tags                  # ã‚¿ã‚°éšå±¤å–å¾—
```

### API ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼

```json
{
  "items": [
    {
      "video_id": "dQw4w9WgXcQ",
      "title": "ã€ãƒ›ãƒ©ãƒ¼ã‚²ãƒ¼ãƒ ã€‘Cry of Fear",
      "tags": ["ã‚²ãƒ¼ãƒ å®Ÿæ³", "ãƒ›ãƒ©ãƒ¼"],
      "year": 2023,
      "thumbnail_url": "https://img.youtube.com/vi/dQw4w9WgXcQ/maxresdefault.jpg",
      "created_at": "2023-10-15T14:30:00Z"
    }
  ],
  "total": 150,
  "limit": 20,
  "offset": 0
}
```

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### å¤šå±¤é˜²å¾¡æˆ¦ç•¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Layer 1: WAF                               â”‚
â”‚  â€¢ SQL Injection é˜²æ­¢                                          â”‚
â”‚  â€¢ XSS æ”»æ’ƒé˜²æ­¢                                                â”‚
â”‚  â€¢ Rate Limiting                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Layer 2: CloudFront                          â”‚
â”‚  â€¢ DDoS ä¿è­·                                                   â”‚
â”‚  â€¢ SSL/TLS çµ‚ç«¯                                                â”‚
â”‚  â€¢ Origin Access Identity                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Layer 3: API Gateway                         â”‚
â”‚  â€¢ CORS è¨­å®š                                                   â”‚
â”‚  â€¢ Request/Response å¤‰æ›                                       â”‚
â”‚  â€¢ Throttling                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Layer 4: Lambda                              â”‚
â”‚  â€¢ Input Validation (Pydantic)                                â”‚
â”‚  â€¢ Business Logic Security                                     â”‚
â”‚  â€¢ IAM Role ã«ã‚ˆã‚‹æœ€å°æ¨©é™                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Layer 5: DynamoDB                            â”‚
â”‚  â€¢ ä¿å­˜æ™‚æš—å·åŒ–                                                â”‚
â”‚  â€¢ VPC Endpoint (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)                                   â”‚
â”‚  â€¢ Fine-grained Access Control                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### IAM ãƒ­ãƒ¼ãƒ«è¨­è¨ˆ

#### Lambda å®Ÿè¡Œãƒ­ãƒ¼ãƒ«
```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "dynamodb:Query",
        "dynamodb:GetItem",
        "dynamodb:PutItem",
        "dynamodb:UpdateItem",
        "dynamodb:DeleteItem"
      ],
      "Resource": "arn:aws:dynamodb:ap-northeast-1:*:table/ArchiveMetadata-*"
    },
    {
      "Effect": "Allow",
      "Action": [
        "s3:GetObject"
      ],
      "Resource": "arn:aws:s3:::shirayuki-tomo-fansite-*/*"
    },
    {
      "Effect": "Allow",
      "Action": [
        "logs:CreateLogGroup",
        "logs:CreateLogStream",
        "logs:PutLogEvents"
      ],
      "Resource": "arn:aws:logs:ap-northeast-1:*:*"
    }
  ]
}
```

## ğŸ“ˆ ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£è¨­è¨ˆ

### è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°æˆ¦ç•¥

#### Lambda é–¢æ•°
- **åŒæ™‚å®Ÿè¡Œæ•°**: 1000ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
- **äºˆç´„åŒæ™‚å®Ÿè¡Œ**: æœ¬ç•ªç’°å¢ƒã§è¨­å®š
- **ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°æ¸ˆã¿åŒæ™‚å®Ÿè¡Œ**: å¿…è¦ã«å¿œã˜ã¦è¨­å®š

#### DynamoDB
- **ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰ã‚­ãƒ£ãƒ‘ã‚·ãƒ†ã‚£**: è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°
- **èª­ã¿å–ã‚Š/æ›¸ãè¾¼ã¿**: ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã«å¿œã˜ã¦è‡ªå‹•èª¿æ•´
- **GSI**: ç‹¬ç«‹ã—ãŸã‚­ãƒ£ãƒ‘ã‚·ãƒ†ã‚£è¨­å®š

#### CloudFront
- **ã‚¨ãƒƒã‚¸ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³**: ä¸–ç•Œä¸­ã«åˆ†æ•£
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥**: é™çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®é•·æœŸã‚­ãƒ£ãƒƒã‚·ãƒ¥

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

```python
# Lambda é–¢æ•°ã®æœ€é©åŒ–ä¾‹
import json
from functools import lru_cache
from typing import Dict, Any

# æ¥ç¶šã®å†åˆ©ç”¨
dynamodb = boto3.resource('dynamodb')
table = dynamodb.Table(os.environ['DYNAMODB_TABLE_NAME'])

@lru_cache(maxsize=128)
def get_cached_data(cache_key: str) -> Dict[str, Any]:
    """ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ä»˜ããƒ‡ãƒ¼ã‚¿å–å¾—"""
    # å®Ÿè£…
    pass

# ã‚³ãƒ¼ãƒ«ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆå¯¾ç­–
def lambda_handler(event, context):
    # æœ€å°é™ã®åˆæœŸåŒ–å‡¦ç†
    pass
```

## ğŸ” ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ãƒ»ãƒ­ã‚°è¨­è¨ˆ

### CloudWatch ãƒ¡ãƒˆãƒªã‚¯ã‚¹

#### Lambda ãƒ¡ãƒˆãƒªã‚¯ã‚¹
- **Duration**: å®Ÿè¡Œæ™‚é–“
- **Errors**: ã‚¨ãƒ©ãƒ¼æ•°
- **Throttles**: ã‚¹ãƒ­ãƒƒãƒˆãƒªãƒ³ã‚°æ•°
- **Invocations**: å®Ÿè¡Œå›æ•°

#### DynamoDB ãƒ¡ãƒˆãƒªã‚¯ã‚¹
- **ConsumedReadCapacityUnits**: èª­ã¿å–ã‚Šæ¶ˆè²»é‡
- **ConsumedWriteCapacityUnits**: æ›¸ãè¾¼ã¿æ¶ˆè²»é‡
- **ThrottledRequests**: ã‚¹ãƒ­ãƒƒãƒˆãƒªãƒ³ã‚°æ•°

#### CloudFront ãƒ¡ãƒˆãƒªã‚¯ã‚¹
- **Requests**: ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°
- **BytesDownloaded**: ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰é‡
- **4xxErrorRate**: 4xx ã‚¨ãƒ©ãƒ¼ç‡
- **5xxErrorRate**: 5xx ã‚¨ãƒ©ãƒ¼ç‡

### ãƒ­ã‚°è¨­è¨ˆ

```python
import logging
import json
from datetime import datetime

# æ§‹é€ åŒ–ãƒ­ã‚°ã®ä¾‹
logger = logging.getLogger(__name__)

def log_api_request(event: dict, response: dict, duration: float):
    """API ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ­ã‚°å‡ºåŠ›"""
    log_data = {
        "timestamp": datetime.utcnow().isoformat(),
        "request_id": event.get("requestContext", {}).get("requestId"),
        "method": event.get("httpMethod"),
        "path": event.get("path"),
        "status_code": response.get("statusCode"),
        "duration_ms": duration * 1000,
        "user_agent": event.get("headers", {}).get("User-Agent"),
        "ip_address": event.get("requestContext", {}).get("identity", {}).get("sourceIp")
    }
    logger.info(json.dumps(log_data))
```

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### Infrastructure as Code (IaC)

```python
# AWS CDK ã«ã‚ˆã‚‹ Infrastructure as Code
from aws_cdk import (
    Stack,
    aws_lambda as lambda_,
    aws_dynamodb as dynamodb,
    aws_s3 as s3,
    aws_cloudfront as cloudfront,
    aws_apigatewayv2 as apigwv2,
)

class BaseStack(Stack):
    def __init__(self, scope, construct_id, environment, **kwargs):
        super().__init__(scope, construct_id, **kwargs)

        # DynamoDB ãƒ†ãƒ¼ãƒ–ãƒ«
        self.dynamodb_table = self._create_dynamodb_table()

        # Lambda é–¢æ•°
        self.lambda_function = self._create_lambda_function()

        # API Gateway
        self.api_gateway = self._create_api_gateway()

        # S3 ãƒã‚±ãƒƒãƒˆ
        self.s3_bucket = self._create_s3_bucket()

        # CloudFront ãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³
        self.cloudfront_distribution = self._create_cloudfront_distribution()
```

### CI/CD ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

```yaml
# GitHub Actions ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
name: CI/CD Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Run Tests
        run: |
          # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ
          cd frontend && npm test
          # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ
          cd backend && uv run pytest
          # ã‚¤ãƒ³ãƒ•ãƒ©ãƒ†ã‚¹ãƒˆ
          cd infrastructure && uv run pytest

  deploy:
    needs: test
    runs-on: ubuntu-latest
    steps:
      - name: Deploy Infrastructure
        run: |
          cd infrastructure
          uv run cdk deploy --require-approval never
```

## ğŸ”„ ç½å®³å¾©æ—§ãƒ»ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æˆ¦ç•¥

### ãƒ‡ãƒ¼ã‚¿ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

#### DynamoDB
- **Point-in-Time Recovery**: 35æ—¥é–“ã®è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
- **On-Demand Backup**: æ‰‹å‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆ
- **Cross-Region Replication**: å¿…è¦ã«å¿œã˜ã¦è¨­å®š

#### S3
- **Versioning**: ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°æœ‰åŠ¹
- **Cross-Region Replication**: ç½å®³å¾©æ—§ç”¨
- **Lifecycle Policy**: å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®è‡ªå‹•å‰Šé™¤

### ç½å®³å¾©æ—§æ‰‹é †

1. **RTO (Recovery Time Objective)**: 4æ™‚é–“
2. **RPO (Recovery Point Objective)**: 1æ™‚é–“
3. **å¾©æ—§æ‰‹é †**:
   - CloudFormation ã‚¹ã‚¿ãƒƒã‚¯ã®å†ä½œæˆ
   - DynamoDB ãƒ‡ãƒ¼ã‚¿ã®å¾©å…ƒ
   - S3 ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å¾©å…ƒ
   - DNS è¨­å®šã®æ›´æ–°

## ğŸ“Š ã‚³ã‚¹ãƒˆæœ€é©åŒ–

### æ–™é‡‘ãƒ¢ãƒ‡ãƒ«

#### å¾“é‡èª²é‡‘ã‚µãƒ¼ãƒ“ã‚¹
- **Lambda**: å®Ÿè¡Œæ™‚é–“ãƒ»ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡
- **DynamoDB**: èª­ã¿æ›¸ãè¦æ±‚æ•°
- **S3**: ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ä½¿ç”¨é‡ãƒ»ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°
- **CloudFront**: ãƒ‡ãƒ¼ã‚¿è»¢é€é‡

#### å›ºå®šè²»ç”¨ã‚µãƒ¼ãƒ“ã‚¹
- **Route 53**: ãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³æ–™é‡‘
- **WAF**: WebACL æ–™é‡‘

### ã‚³ã‚¹ãƒˆå‰Šæ¸›æˆ¦ç•¥

1. **Lambda æœ€é©åŒ–**
   - ãƒ¡ãƒ¢ãƒªã‚µã‚¤ã‚ºã®é©åˆ‡ãªè¨­å®š
   - å®Ÿè¡Œæ™‚é–“ã®æœ€å°åŒ–
   - ä¸è¦ãªä¾å­˜é–¢ä¿‚ã®å‰Šé™¤

2. **DynamoDB æœ€é©åŒ–**
   - ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰ã‚­ãƒ£ãƒ‘ã‚·ãƒ†ã‚£ã®æ´»ç”¨
   - ä¸è¦ãªãƒ‡ãƒ¼ã‚¿ã®å®šæœŸå‰Šé™¤
   - GSI ã®é©åˆ‡ãªè¨­è¨ˆ

3. **S3 æœ€é©åŒ–**
   - ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒãƒªã‚·ãƒ¼ã®è¨­å®š
   - ä¸è¦ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®å‰Šé™¤
   - é©åˆ‡ãªã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚¯ãƒ©ã‚¹ã®é¸æŠ

## ğŸ”® å°†æ¥ã®æ‹¡å¼µè¨ˆç”»

### çŸ­æœŸè¨ˆç”»ï¼ˆ3-6ãƒ¶æœˆï¼‰
- **èªè¨¼æ©Ÿèƒ½**: AWS Cognito ã«ã‚ˆã‚‹èªè¨¼
- **ç®¡ç†ç”»é¢**: å‹•ç”»ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®ç®¡ç†æ©Ÿèƒ½
- **é€šçŸ¥æ©Ÿèƒ½**: æ–°ç€å‹•ç”»ã®é€šçŸ¥

### ä¸­æœŸè¨ˆç”»ï¼ˆ6-12ãƒ¶æœˆï¼‰
- **æ¤œç´¢æ©Ÿèƒ½å¼·åŒ–**: Elasticsearch ã«ã‚ˆã‚‹å…¨æ–‡æ¤œç´¢
- **ãƒ¬ã‚³ãƒ¡ãƒ³ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³**: æ©Ÿæ¢°å­¦ç¿’ã«ã‚ˆã‚‹æ¨è–¦æ©Ÿèƒ½
- **ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒª**: React Native ã«ã‚ˆã‚‹å°‚ç”¨ã‚¢ãƒ—ãƒª

### é•·æœŸè¨ˆç”»ï¼ˆ1å¹´ä»¥ä¸Šï¼‰
- **ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆ**: è¤‡æ•°VTuberå¯¾å¿œ
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ©Ÿèƒ½**: WebSocket ã«ã‚ˆã‚‹å³åº§æ›´æ–°
- **AIæ©Ÿèƒ½**: å‹•ç”»å†…å®¹ã®è‡ªå‹•ã‚¿ã‚°ä»˜ã‘

---

## ğŸ“ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«é–¢ã™ã‚‹è³ªå•ãƒ»ææ¡ˆ

ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«é–¢ã™ã‚‹è³ªå•ã‚„æ”¹å–„ææ¡ˆã¯ã€ä»¥ä¸‹ã§å—ã‘ä»˜ã‘ã¦ã„ã¾ã™ï¼š

- **GitHub Issues**: æŠ€è¡“çš„ãªè³ªå•ãƒ»ææ¡ˆ
- **GitHub Discussions**: ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆã®è­°è«–
- **Architecture Decision Records (ADR)**: é‡è¦ãªè¨­è¨ˆæ±ºå®šã®è¨˜éŒ²

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€ã‚·ã‚¹ãƒ†ãƒ ã®æˆé•·ã¨ã¨ã‚‚ã«ç¶™ç¶šçš„ã«æ›´æ–°ã•ã‚Œã¾ã™ã€‚
