# 動画詳細画面仕様書

## 1. 画面の役割（Why/What）

### 核心的役割
動画詳細画面は、ユーザーが特定の動画に対してより深い情報を得るための専用ページとして機能します。サムネイルだけでは伝わらない詳細情報を提供し、最終的にはYouTubeでの視聴へと誘導することで、白雪巴の動画コンテンツとの接点を深めます。

### 機能的役割
- **詳細情報提供**: 動画タイトル、投稿日、タグ、概要などの包括的な情報表示
- **YouTube誘導**: 元動画への直接アクセスを提供
- **ナビゲーション**: アーカイブサイト内の他の動画への導線提供
- **コンテキスト提供**: タグや関連性による動画の位置づけ明確化

## 2. 機能詳細（How）

### URL構造
- **パス**: `/video/[id]`
- **パラメータ**: `id` - 動画の一意識別子（video_id）

### コンポーネント構成

#### メインコンポーネント
- **VideoDetailPage**: ページ全体の管理コンポーネント
- **VideoHero**: 動画の基本情報とサムネイル表示
- **VideoMetadata**: 詳細メタデータの表示
- **YouTubeLink**: YouTube視聴ボタン
- **TagList**: 関連タグ一覧
- **NavigationButtons**: 前後の動画やトップへの遷移

#### レイアウト構造
```
[ヘッダー]
[パンくずナビ]
[動画ヒーロー部]
  - サムネイル（大）
  - タイトル
  - YouTubeリンクボタン
[動画メタデータ部]
  - 投稿日
  - 動画時間
  - タグ一覧
  - 概要（ある場合）
[ナビゲーション部]
  - 戻るボタン
  - 関連動画（将来実装）
[フッター]
```

### API連携

#### 動画詳細取得API
- **エンドポイント**: `GET /api/videos/{video_id}`
- **レスポンス**: Video型オブジェクト
- **エラーハンドリング**: 404 Not Found時の適切な表示

### 状態管理
- **SWR**: 動画データのキャッシュと取得
- **Loading状態**: データ取得中の適切なローディング表示
- **Error状態**: 動画が見つからない場合のエラー画面

### UI動作仕様

#### 表示項目
1. **サムネイル**: 高解像度版の表示（利用可能な場合）
2. **タイトル**: 動画の正式タイトル
3. **投稿日**: 「YYYY年MM月DD日」形式
4. **再生時間**: 「MM:SS」または「HH:MM:SS」形式
5. **タグ**: クリック可能なタグリスト（タグ検索画面への遷移）
6. **YouTubeリンク**: 新しいタブで開く外部リンク

#### インタラクション
- **YouTubeボタン**: 外部リンクとして新タブで開く
- **タグクリック**: タグ検索画面へ遷移（該当タグでフィルタ）
- **戻るボタン**: ブラウザ履歴またはメイン画面への遷移
- **サムネイルクリック**: YouTubeページへ遷移

## 3. デザイン・UI構成（Look & Feel）

### デザイン言語
- **Hero UI**: 既存のデザインシステムを継続
- **カードベース**: 情報を整理されたカード形式で表示
- **ミニマリスト**: 動画コンテンツが主役となるシンプルなデザイン

### レイアウト構造
- **レスポンシブ**: モバイル・タブレット・デスクトップ対応
- **グリッドシステム**: 12カラムベースの柔軟なレイアウト
- **余白**: 適切な余白により情報の階層化

### カラーパレット
- **プライマリ**: YouTube遷移ボタンに赤系色彩
- **セカンダリ**: タグ表示に既存のタグカラー継続
- **テキスト**: 高コントラストによる可読性確保

### インタラクション
- **ホバー効果**: ボタンとリンクに適切なフィードバック
- **ローディング**: スケルトンスクリーンによる待機時間の改善
- **アニメーション**: 控えめなトランジションによる自然な操作感

## 4. 改善要件（Better UX）

### 現在の課題（初期実装時）
- **動画詳細画面の不存在**: サムネイルクリック時の遷移先がない
- **情報の不足**: 動画に関する詳細情報の表示方法がない
- **YouTube誘導の不明確さ**: 視聴への導線が不十分

### 短期改善（Phase 1）
1. **基本機能実装**
   - 動画詳細ページの作成
   - 基本メタデータの表示
   - YouTubeリンクの実装

2. **ナビゲーション改善**
   - サムネイルクリックでの詳細画面遷移
   - 適切な戻るボタンの実装
   - パンくずナビゲーション

### 中期改善（Phase 2）
1. **関連コンテンツ**
   - 同じタグを持つ関連動画の表示
   - 同時期投稿動画の推薦
   - シリーズ動画の連続再生提案

2. **メタデータ拡充**
   - 動画概要の表示（利用可能な場合）
   - 再生回数情報（YouTube APIから取得）
   - コメント数やエンゲージメント指標

### 長期改善（Phase 3）
1. **ソーシャル機能**
   - 動画へのお気に入り登録
   - 視聴履歴の記録
   - 個人的なメモ・タグ付け

2. **高度な推薦**
   - 機械学習による関連動画推薦
   - ユーザー行動に基づくパーソナライゼーション
   - 視聴パターン分析による最適化

## 5. 技術的考慮事項

### パフォーマンス
- **画像最適化**: サムネイルの適切なサイズ配信
- **データプリロード**: 関連動画情報の先読み
- **キャッシュ戦略**: SWRによる効率的なデータ管理

### SEO対策
- **メタタグ**: 動画タイトルと概要の適切な設定
- **構造化データ**: VideoObjectによるリッチスニペット対応
- **URL構造**: SEOフレンドリーなURL設計

### アクセシビリティ
- **スクリーンリーダー**: 適切なaria-labelとセマンティックHTML
- **キーボードナビゲーション**: Tab操作による完全な操作性
- **コントラスト**: WCAG準拠の色彩設計

### スケーラビリティ
- **データ構造**: 将来的なメタデータ拡張への対応
- **API設計**: 効率的なデータ取得とキャッシュ
- **コンポーネント再利用**: 他画面での詳細表示コンポーネント活用

## 6. 実装仕様

### ファイル構成
```
package/web/src/
├── app/
│   └── video/
│       └── [id]/
│           └── page.tsx          # 動画詳細ページ
├── components/
│   ├── video/
│   │   ├── VideoDetail.tsx       # 動画詳細コンポーネント
│   │   ├── VideoHero.tsx         # ヒーロー部分
│   │   ├── VideoMetadata.tsx     # メタデータ表示
│   │   └── YouTubeLink.tsx       # YouTubeリンク
│   └── ui/
│       └── BackButton.tsx        # 戻るボタン
├── types/
│   └── video.ts                  # 型定義の拡張
└── lib/
    └── api.ts                    # API クライアントの拡張
```

### データフロー
1. **URL解析**: `[id]`パラメータの取得
2. **API呼び出し**: `/api/videos/{id}`からデータ取得
3. **データ検証**: 有効な動画データの確認
4. **UI描画**: コンポーネントへのデータ渡し
5. **エラー処理**: 404やネットワークエラーの適切な処理

### 状態管理パターン
```typescript
// SWRを使用したデータ取得
const { data: video, error, isLoading } = useSWR(
  videoId ? `/api/videos/${videoId}` : null,
  fetcher
);

// エラー状態とローディング状態の管理
if (isLoading) return <VideoDetailSkeleton />;
if (error) return <VideoNotFound />;
if (!video) return <VideoNotFound />;
```

## 7. テスト要件

### 単体テスト
- コンポーネントの正常なレンダリング
- プロパティの適切な表示
- エラー状態の処理

### 統合テスト
- API連携の正常動作
- ナビゲーションの機能確認
- レスポンシブデザインの検証

### E2Eテスト
- サムネイルからの遷移フロー
- YouTubeリンクの外部遷移
- 戻るボタンの動作確認

この仕様書は動画詳細画面の基盤となる機能定義であり、実装後のユーザーフィードバックと利用データに基づいて継続的に改善されるべきものです。
