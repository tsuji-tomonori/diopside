# メイン画面仕様書

**URL**: `/`
**ファイル**: `package/web/src/app/page.tsx`

## 1. 画面の役割（Why/What）

### 核心的役割
- **エントリーポイント**: 白雪巴アーカイブサイトの玄関口として、ユーザーが最初に訪れる画面
- **動画発見の起点**: 膨大な動画アーカイブの中から目的の動画を見つけるための主要な導線
- **ブランド表現**: 白雪巴さんのファンサイトとしてのブランドアイデンティティを体現

### 機能的役割
- **年別ブラウジング**: 特定年度の動画を効率的に閲覧
- **概要把握**: 全体的な動画投稿傾向やボリュームの把握
- **他機能への誘導**: タグ検索、ランダム発見、ゲーム機能への導線

## 2. 機能詳細（How）

### 2.1 年度選択機能
**コンポーネント**: `YearSelector`
- **動作**: 2020年〜現在年まで降順で年度を表示
- **UI**: Hero UI の Select コンポーネント、カレンダーアイコン付き
- **即座反映**: 年度選択と同時に動画リストが更新
- **デフォルト**: 現在年を初期選択

### 2.2 動画グリッド表示
**コンポーネント**: `VideoGrid` + `VideoCard`

#### VideoCard 詳細
- **サムネイル**: 16:9アスペクト比、フォールバック（紫グラデーション+タイトル頭文字）
- **タイトル**: 2行まで表示、以降は省略
- **メタ情報**: 年度 + 投稿日（日本語フォーマット）
- **タグ表示**: 最大3個、以降は「+N」で省略
- **インタラクション**: ホバー時のスケール効果（1.05倍）

#### レスポンシブ対応
- **モバイル**: 1列
- **SM（640px〜）**: 2列
- **MD（768px〜）**: 3列
- **LG（1024px〜）**: 4列
- **XL（1280px〜）**: 5列

### 2.3 無限スクロール機能
- **トリガー**: Intersection Observer による自動読み込み
- **閾値**: 0.1（要素の10%が見えた時点）
- **バッチサイズ**: 50件ずつ
- **ページネーション**: `last_key` による DynamoDB 形式

### 2.4 状態管理
- **selectedYear**: 選択中年度
- **allVideos**: 累積動画リスト（重複排除処理あり）
- **lastKey**: ページネーション継続用キー
- **SWR**: サーバー状態管理（キャッシュ、再検証、エラーハンドリング）

## 3. デザイン・UI構成（Look & Feel）

### 3.1 全体的なデザイン言語
- **デザインシステム**: Hero UI + Tailwind CSS
- **カラーパレット**: 紫系統をアクセントカラー（`purple-800`, `purple-600`）
- **ダークモード**: 完全対応、自動切り替え
- **フォント**: システムフォント、日本語対応

### 3.2 レイアウト構造
```
MainLayout
├── Header Section
│   ├── Title: "白雪巴アーカイブ" (text-4xl, purple-800)
│   ├── Subtitle: "白雪巴さんの動画アーカイブサイト" (purple-600)
│   └── YearSelector (max-w-xs, centered)
├── Error Section (conditional)
│   └── ErrorMessage with Retry
├── VideoGrid Section
│   ├── Responsive Grid (gap-6)
│   ├── VideoCards
│   └── InfiniteScroll Trigger
└── Empty State (conditional)
    └── "動画が見つかりませんでした"
```

### 3.3 視覚的階層
1. **第1階層**: サイトタイトル（最も目立つ）
2. **第2階層**: 年度選択UI（機能的重要度高）
3. **第3階層**: 動画グリッド（主要コンテンツ）
4. **第4階層**: 個別動画情報（サポート情報）

### 3.4 マイクロインタラクション
- **VideoCard**: ホバー時の軽快なスケール変化
- **Select**: Hero UI標準のアニメーション
- **Loading**: 統一されたローディングスピナー
- **Error**: 目立つが威圧的でないエラー表示

## 4. 改善要件（Better UX）

### 4.1 検索・発見性の向上
**現在の課題**: 年度フィルタのみで検索手段が限定的

#### 提案改善
- **キーワード検索**: タイトル・説明文での全文検索
- **複合フィルタ**: 年度 + タグの組み合わせ検索
- **検索履歴**: よく検索される条件の保存・提案
- **サジェスト機能**: 入力中のリアルタイム候補表示

### 4.2 ソート・並び順の柔軟性
**現在の課題**: 投稿日順固定で他の観点での並び替えができない

#### 提案改善
- **ソートオプション**: 投稿日、タイトル、再生数（データがあれば）
- **昇順・降順**: 切り替え可能
- **人気順**: お気に入り数やアクセス数による並び替え

### 4.3 動画詳細表示の強化
**現在の課題**: 動画クリックが `console.log` のみで機能していない

#### 提案改善
- **モーダル詳細**: クリック時の詳細情報表示
- **動画プレビュー**: サムネイルホバー時の簡易プレビュー
- **関連動画**: 同じタグの他動画への誘導
- **外部リンク**: 元動画（YouTube等）への適切なリンク

### 4.4 パーソナライゼーション機能
**現在の課題**: 全ユーザー共通の体験で個人の嗜好に対応していない

#### 提案改善
- **お気に入り機能**: ローカルストレージによる保存
- **視聴履歴**: 見た動画の記録とマーク表示
- **おすすめ表示**: 履歴に基づく関連動画推薦
- **カスタムタグ**: ユーザー独自のタグ付け機能

### 4.5 パフォーマンス・操作性向上
**現在の課題**: 大量データでの表示速度とUX

#### 提案改善
- **プリローディング**: 次ページのプリフェッチ
- **スケルトンローディング**: より自然なローディング表示
- **仮想スクロール**: 極大データセット対応
- **キーボードナビ**: アクセシビリティ向上

### 4.6 情報アーキテクチャの改善
**現在の課題**: 動画数が多い年度での情報量過多

#### 提案改善
- **月別グルーピング**: 年内での月別表示オプション
- **統計情報**: 年度別投稿数、タグ分布の可視化
- **フィルタリング状況表示**: 現在の絞り込み条件の明示
- **一括操作**: 複数動画の同時お気に入り登録

### 4.7 他機能との連携強化
**現在の課題**: 他画面への導線が弱い

#### 提案改善
- **クイックアクション**: グリッドからのタグ検索ワンクリック
- **ランダム起点**: 「この年度からランダム」機能
- **ゲーム連携**: 表示中動画からのメモリーゲーム生成
- **シェア機能**: 特定年度・条件のURL共有

## 5. 技術的考慮事項

### 5.1 パフォーマンス最適化
- **画像最適化**: WebP対応、適切なサイズ調整
- **レイジーローディング**: 画面外画像の遅延読み込み
- **メモリ管理**: 長時間スクロール時のメモリリーク対策

### 5.2 アクセシビリティ
- **キーボード操作**: Tab移動、Enter/Space選択
- **スクリーンリーダー**: 適切な aria-label、alt属性
- **コントラスト**: WCAG AA準拠の色彩設計

### 5.3 SEO・メタデータ
- **動的タイトル**: 選択年度の反映
- **OGP対応**: 年度別のシェア情報
- **構造化データ**: 動画情報のSchema.org対応
